# API密钥配置指南

## 🎯 快速配置（推荐）

### 方法一：自动弹窗配置

首次访问CSDN页面时，脚本会自动显示配置弹窗：

1. **弹窗界面**
   - 🔑 精美的对话框设计
   - 输入框自动聚焦
   - 支持回车键提交

2. **配置步骤**
   ```
   访问CSDN页面 → 弹出配置窗口 → 输入密钥 → 点击确定 → 自动刷新
   ```

3. **弹窗特点**
   - ✅ 深色主题，不刺眼
   - ✅ 渐变色设计，美观大方
   - ✅ 输入验证，防止空密钥
   - ✅ 本地存储，持久保存
   - ✅ 自动刷新，即时生效

### 弹窗UI设计

```
┌────────────────────────────────────┐
│         🔑 配置API密钥             │
│  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │
│                                    │
│  首次使用需要配置API密钥，         │
│  请输入您的密钥以继续：            │
│                                    │
│  ┌──────────────────────────────┐ │
│  │ 请输入API密钥                │ │
│  └──────────────────────────────┘ │
│                                    │
│  💡 提示：                         │
│  • 密钥将安全保存在浏览器本地存储  │
│  • 如需修改，可以在控制台执行：    │
│    GM_setValue('csdn_api_key', '') │
│                                    │
│  [ 取消 ]          [ 确定 ]        │
└────────────────────────────────────┘
```

## 🔧 其他配置方法

### 方法二：控制台命令

适合开发者或需要修改密钥的情况：

```javascript
// 在浏览器控制台（F12）执行
GM_setValue('csdn_api_key', '你的API密钥')

// 然后刷新页面
location.reload()
```

### 方法三：直接修改脚本

适合长期使用固定密钥的情况：

1. 打开油猴脚本编辑器
2. 找到配置部分（第23-38行）
3. 修改 `apiKey` 的默认值：

```javascript
const CONFIG = {
    apiBaseUrl: 'http://175.24.164.85/api',

    // 将空字符串改为你的密钥
    apiKey: GM_getValue('csdn_api_key', '你的API密钥'),

    // 其他配置...
};
```

## 🔑 获取API密钥

### 联系管理员

如果你是普通用户，请联系项目管理员获取密钥。

### 自己创建（部署者）

如果你是项目部署者，可以通过管理接口创建密钥：

```bash
# 使用curl创建
curl -X POST "http://175.24.164.85/api/admin/api-keys" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "油猴脚本用户1",
    "description": "用于CSDN Helper脚本"
  }'

# 返回示例
{
  "key": "uk_xxxxxxxxxxxxxxxxxxxx",
  "name": "油猴脚本用户1",
  "created_at": "2025-01-10T12:00:00"
}
```

## ❓ 常见问题

### Q1: 弹窗没有出现？

**可能原因**：
- 已经配置过密钥
- 脚本未正确加载

**解决方案**：
1. 检查油猴图标是否显示脚本已激活
2. 刷新页面重试
3. 使用方法二或方法三配置

### Q2: 输入密钥后点击确定没反应？

**可能原因**：
- 密钥为空
- 浏览器不支持GM_setValue

**解决方案**：
1. 确保输入了密钥
2. 检查浏览器控制台是否有错误
3. 更新Tampermonkey到最新版本

### Q3: 如何修改已保存的密钥？

**方法一**：在控制台重新执行
```javascript
GM_setValue('csdn_api_key', '新的API密钥')
location.reload()
```

**方法二**：清除旧密钥后刷新
```javascript
GM_deleteValue('csdn_api_key')
location.reload()  // 刷新后会重新弹出配置窗口
```

### Q4: 密钥保存在哪里？

密钥保存在浏览器的Tampermonkey扩展存储中，具体位置：
- **Chrome**: Chrome的扩展数据目录
- **Firefox**: Firefox的扩展数据目录

**安全性**：
- ✅ 不会发送到任何第三方服务器
- ✅ 仅在你的浏览器本地存储
- ✅ 只有Tampermonkey可以访问
- ✅ 清除浏览器数据时会一起清除

### Q5: 忘记密钥了怎么办？

**方法一**：查看当前密钥
```javascript
// 在控制台执行
console.log(GM_getValue('csdn_api_key'))
```

**方法二**：联系管理员重新获取

## 🎨 弹窗UI特性

### 视觉设计
- **渐变背景**：紫色渐变（#667eea → #764ba2）
- **深色主题**：保护眼睛，适合长时间使用
- **圆角设计**：现代化UI风格
- **阴影效果**：增加层次感

### 交互设计
- **自动聚焦**：弹窗显示后自动聚焦输入框
- **回车提交**：支持键盘快捷操作
- **悬停效果**：按钮悬停时视觉反馈
- **输入验证**：防止空密钥提交

### 响应式设计
- **移动端适配**：最大宽度90vw
- **桌面端优化**：固定宽度500px
- **高DPI支持**：矢量图标，清晰锐利

## 📚 相关文档

- [完整使用指南](USERSCRIPT_GUIDE.md)
- [快速入门](README_USERSCRIPT.md)
- [项目主页](https://github.com/minglu6/unlock-vip)

## 💡 提示

配置成功后，脚本会：
1. 自动在VIP内容页面显示"🔓 一键解锁"按钮
2. 在右下角显示日志面板
3. 记录所有操作日志

祝使用愉快！🎉

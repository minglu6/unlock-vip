# ğŸ”“ unlock-vip# CS## âœ¨ ç‰¹æ€§



ä¸€ä¸ªåŸºäº FastAPI + Celery çš„ CSDN æ–‡ç« æ™ºèƒ½ä¸‹è½½æœåŠ¡ï¼Œæ”¯æŒåšå®¢æ–‡ç« å’Œæ–‡åº“æ–‡æ¡£çš„è‡ªåŠ¨è§£æä¸ä¸‹è½½ã€‚- ğŸš€ **å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—** - åŸºäº Celery + Redis

- ğŸ”“ **VIP è‡ªåŠ¨è§£é”** - è‡ªåŠ¨æ£€æµ‹å¹¶è§£é” VIP æ–‡ç« 

[![Python](https://img.shields.io/badge/Python-3.9+-blue.svg)](https://www.python.org/)- ğŸ” **API Key è®¤è¯** - åŸºäºå¯†é’¥çš„è®¿é—®æ§åˆ¶

[![FastAPI](https://img.shields.io/badge/FastAPI-0.115+-green.svg)](https://fastapi.tiangolo.com/)- ğŸ“Š **è¯·æ±‚æ—¥å¿—è®°å½•** - å®Œæ•´çš„ API è°ƒç”¨æ—¥å¿—

[![Celery](https://img.shields.io/badge/Celery-5.4+-red.svg)](https://docs.celeryproject.org/)- â±ï¸ **é¢‘ç‡é™åˆ¶** - æ”¯æŒåˆ†é’Ÿ/å°æ—¶/å¤©çº§åˆ«çš„é™æµ

[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)- ğŸ§¹ **è‡ªåŠ¨æ–‡ä»¶æ¸…ç†** - å®šæœŸæ¸…ç†æ—§çš„ä¸‹è½½æ–‡ä»¶

- ğŸ“„ **çº¯å‡€æ¨¡å¼** - åªä¿å­˜æ–‡ç« æ ¸å¿ƒå†…å®¹

## âœ¨ æ ¸å¿ƒç‰¹æ€§- âš¡ **å¹¶å‘å¤„ç†** - æ”¯æŒåŒæ—¶å¤„ç†å¤šä¸ªä¸‹è½½è¯·æ±‚

- ğŸ¯ **ç®€å•æ˜“ç”¨** - ç»Ÿä¸€çš„ REST API æ¥å£

### ğŸš€ å¼‚æ­¥å¤„ç†ä¸€ä¸ªåŸºäº FastAPI + Celery çš„ CSDN æ–‡ç« ä¸‹è½½æœåŠ¡ï¼Œæ”¯æŒ VIP æ–‡ç« è‡ªåŠ¨è§£é”ã€‚

- **Celeryä»»åŠ¡é˜Ÿåˆ—** - åŸºäºRedisçš„åˆ†å¸ƒå¼ä»»åŠ¡å¤„ç†

- **å¹¶å‘ä¸‹è½½** - æ”¯æŒåŒæ—¶å¤„ç†å¤šä¸ªä¸‹è½½è¯·æ±‚## âœ¨ ç‰¹æ€§

- **ä»»åŠ¡çŠ¶æ€è¿½è¸ª** - å®æ—¶æŸ¥è¯¢ä»»åŠ¡è¿›åº¦å’Œç»“æœ

- ğŸš€ **å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—** - åŸºäº Celery + Redis

### ğŸ“š å¤šæ ¼å¼æ”¯æŒ- ğŸ”“ **VIP è‡ªåŠ¨è§£é”** - è‡ªåŠ¨æ£€æµ‹å¹¶è§£é” VIP æ–‡ç« 

- **åšå®¢æ–‡ç« ** (`blog.csdn.net`) - å®Œæ•´æå–æ–‡ç« å†…å®¹- ï¿½ **API Key è®¤è¯** - åŸºäºå¯†é’¥çš„è®¿é—®æ§åˆ¶

- **æ–‡åº“æ–‡æ¡£** (`wenku.csdn.net`) - Markdownæ¸²æŸ“+è¯­æ³•é«˜äº®- ğŸ“Š **è¯·æ±‚æ—¥å¿—è®°å½•** - å®Œæ•´çš„ API è°ƒç”¨æ—¥å¿—

- **ä»£ç é«˜äº®** - è‡ªåŠ¨è¯†åˆ«ä»£ç å—å¹¶åº”ç”¨è¯­æ³•ç€è‰²- â±ï¸ **é¢‘ç‡é™åˆ¶** - æ”¯æŒåˆ†é’Ÿ/å°æ—¶/å¤©çº§åˆ«çš„é™æµ

- **æ ¼å¼ä¿ç•™** - ä¿æŒåŸæ–‡æ’ç‰ˆå’Œæ ·å¼- ï¿½ğŸ“„ **çº¯å‡€æ¨¡å¼** - åªä¿å­˜æ–‡ç« æ ¸å¿ƒå†…å®¹

- âš¡ **å¹¶å‘å¤„ç†** - æ”¯æŒåŒæ—¶å¤„ç†å¤šä¸ªä¸‹è½½è¯·æ±‚

### ğŸ” å®‰å…¨è®¤è¯- ğŸ¯ **ç®€å•æ˜“ç”¨** - ç»Ÿä¸€çš„ REST API æ¥å£

- **API Keyè®¤è¯** - åŸºäºå¯†é’¥çš„è®¿é—®æ§åˆ¶

- **ç®¡ç†å‘˜ç³»ç»Ÿ** - ç‹¬ç«‹çš„ç®¡ç†å‘˜å¯†é’¥ç®¡ç†## ğŸš€ å¿«é€Ÿå¼€å§‹

- **é€Ÿç‡é™åˆ¶** - åˆ†é’Ÿ/å°æ—¶/å¤©çº§åˆ«çš„è¯·æ±‚é™æµ

- **è¯·æ±‚æ—¥å¿—** - å®Œæ•´è®°å½•æ‰€æœ‰APIè°ƒç”¨### 1. å®‰è£…ä¾èµ–



### ğŸ§¹ æ™ºèƒ½ç®¡ç†```bash

- **è‡ªåŠ¨æ¸…ç†** - å®šæœŸæ¸…ç†è¿‡æœŸä¸‹è½½æ–‡ä»¶pip install -r requirements.txt

- **çº¯å‡€æ¨¡å¼** - åªä¿å­˜æ–‡ç« æ ¸å¿ƒå†…å®¹```

- **é”™è¯¯é‡è¯•** - è‡ªåŠ¨é‡è¯•å¤±è´¥çš„ä¸‹è½½ä»»åŠ¡

### 2. é…ç½®ç¯å¢ƒ

## ğŸ“¦ æŠ€æœ¯æ ˆ

å¤åˆ¶ `.env.example` ä¸º `.env` å¹¶é…ç½®ï¼š

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |

|------|------|------|------|```env

| **Webæ¡†æ¶** | FastAPI | 0.115+ | é«˜æ€§èƒ½å¼‚æ­¥Webæ¡†æ¶ |# MySQL æ•°æ®åº“é…ç½®

| **ä»»åŠ¡é˜Ÿåˆ—** | Celery | 5.4+ | åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ— |DATABASE_HOST=localhost

| **æ¶ˆæ¯ä»£ç†** | Redis | 6.0+ | ä»»åŠ¡brokerå’Œç»“æœåç«¯ |DATABASE_PORT=3306

| **æ•°æ®åº“** | MySQL | 8.0+ | æ•°æ®æŒä¹…åŒ– |DATABASE_USER=root

| **ORM** | SQLAlchemy | 2.0+ | æ•°æ®åº“ORM |DATABASE_PASSWORD=your_password

| **HTMLè§£æ** | BeautifulSoup4 | 4.12+ | ç½‘é¡µå†…å®¹æå– |DATABASE_NAME=unlock_vip

| **Markdownæ¸²æŸ“** | Python-Markdown | 3.7+ | Markdownè½¬HTML |

| **ä»£ç é«˜äº®** | Pygments | 2.18+ | è¯­æ³•é«˜äº® |# ç®¡ç†å‘˜è®¤è¯å¯†é’¥ï¼ˆç”¨äºç®¡ç† API Keysï¼‰

ADMIN_MASTER_KEY=your_admin_master_key

## ğŸš€ å¿«é€Ÿå¼€å§‹

# CSDN è´¦å·

### æ–¹å¼ä¸€ï¼šDockeréƒ¨ç½²ï¼ˆæ¨èï¼‰CSDN_USERNAME=your_username

CSDN_PASSWORD=your_password

```bash

# 1. å…‹éš†é¡¹ç›®# Redis

git clone https://github.com/minglu6/unlock-vip.gitREDIS_HOST=localhost

cd unlock-vipREDIS_PORT=6379

```

# 2. é…ç½®ç¯å¢ƒå˜é‡

cp .env.example .env**ç”Ÿæˆç®¡ç†å‘˜å¯†é’¥ï¼š**

# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“å¯†ç ç­‰

```bash

# 3. å¯åŠ¨æœåŠ¡python generate_admin_key.py

docker-compose up -d```



# 4. ç”Ÿæˆç®¡ç†å‘˜å¯†é’¥**åˆå§‹åŒ–æ•°æ®åº“ï¼š**

docker-compose exec app python scripts/generate_admin_key.py

```bash

# 5. è®¿é—®APIæ–‡æ¡£# åˆ›å»ºæ•°æ®åº“è¡¨

# http://localhost:8000/docspython manage_db.py init

```

# åˆ›å»ºç¬¬ä¸€ä¸ª API Key

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘python manage_db.py create "æˆ‘çš„å¯†é’¥"

```

```bash

# 1. å®‰è£…ä¾èµ–### 3. å¯åŠ¨æœåŠ¡

pip install -r requirements.txt

```bash

# 2. é…ç½®ç¯å¢ƒ# 1. å¯åŠ¨ Redis

cp .env.example .envdocker run -d --name unlock-vip-redis -p 6379:6379 redis:latest

# ç¼–è¾‘ .env æ–‡ä»¶

# 2. å¯åŠ¨ Celery Workerï¼ˆæ–°ç»ˆç«¯ï¼‰

# 3. å¯åŠ¨MySQLå’ŒRediscelery -A app.core.celery_app worker --loglevel=info -P solo --pool=solo

# ç¡®ä¿MySQLå’ŒRedisæœåŠ¡æ­£åœ¨è¿è¡Œ

# 3. å¯åŠ¨ API æœåŠ¡å™¨ï¼ˆæ–°ç»ˆç«¯ï¼‰

# 4. å¯åŠ¨FastAPIpython run.py

python run.py```



# 5. å¯åŠ¨Celery Workerï¼ˆæ–°ç»ˆç«¯ï¼‰### 4. æµ‹è¯•

celery -A celery_worker worker --loglevel=info --pool=solo

```bash

# 6. ç”ŸæˆAPIå¯†é’¥python tests/test_simple.py

python scripts/generate_admin_key.py```

```

æˆ–è®¿é—® API æ–‡æ¡£: http://localhost:8000/docs

è¯¦ç»†è¯´æ˜è¯·æŸ¥çœ‹ [å¿«é€Ÿå…¥é—¨æŒ‡å—](docs/QUICK_START.md) æˆ– [Dockerå¿«é€Ÿå¯åŠ¨](docs/DOCKER_QUICKSTART.md)ã€‚

## ğŸ“¡ API ä½¿ç”¨

## ğŸ“– æ–‡æ¡£

### è®¤è¯

å®Œæ•´æ–‡æ¡£è¯·è®¿é—® [æ–‡æ¡£ä¸­å¿ƒ](docs/README.md)ã€‚

æ‰€æœ‰ API è¯·æ±‚éƒ½éœ€è¦åœ¨ Header ä¸­æä¾› API Keyï¼š

### å¿«é€Ÿé“¾æ¥

```bash

| æ–‡æ¡£ | è¯´æ˜ |X-API-Key: your_api_key_here

|------|------|```

| [å¿«é€Ÿå…¥é—¨](docs/QUICK_START.md) | 5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²å’Œè¿è¡Œ |

| [APIå‚è€ƒ](docs/API_QUICK_REFERENCE.md) | å®Œæ•´çš„APIç«¯ç‚¹æ–‡æ¡£ |### ä¸‹è½½æ–‡ç« 

| [Dockeréƒ¨ç½²](docs/DOCKER_DEPLOYMENT.md) | Dockerå®¹å™¨åŒ–éƒ¨ç½² |

| [APIè®¤è¯](docs/API_AUTHENTICATION.md) | è®¤è¯ç³»ç»Ÿé…ç½® |**ç«¯ç‚¹:** `POST /api/article/download`

| [ç¤ºä¾‹ç”¨æ³•](docs/example_usage.md) | å®é™…ä½¿ç”¨ç¤ºä¾‹ |

**Headers:**

## ğŸ¯ ä½¿ç”¨ç¤ºä¾‹```

X-API-Key: your_api_key_here

### ä¸‹è½½åšå®¢æ–‡ç« Content-Type: application/json

```

```bash

# 1. æäº¤ä¸‹è½½ä»»åŠ¡**è¯·æ±‚:**

curl -X POST "http://localhost:8000/api/article/submit" \```json

  -H "X-API-Key: YOUR_API_KEY" \{

  -H "Content-Type: application/json" \    "url": "https://blog.csdn.net/xxx/article/details/123456"

  -d '{"url": "https://blog.csdn.net/username/article/details/123456"}'}

```

# å“åº”

{**å“åº”:**

  "task_id": "abc123-def456-ghi789",```json

  "status": "pending",{

  "message": "ä»»åŠ¡å·²æäº¤"    "success": true,

}    "content": "<html>...</html>",

    "file_size": 13152,

# 2. æŸ¥è¯¢ä»»åŠ¡çŠ¶æ€    "title": "æ–‡ç« æ ‡é¢˜",

curl "http://localhost:8000/api/article/status/abc123-def456-ghi789" \    "error": null

  -H "X-API-Key: YOUR_API_KEY"}

```

# 3. è·å–æ–‡ç« å†…å®¹

curl "http://localhost:8000/api/article/result/abc123-def456-ghi789" \**cURL ç¤ºä¾‹ï¼š**

  -H "X-API-Key: YOUR_API_KEY"

``````bash

curl -X POST "http://localhost:8000/api/article/download" \

### ä¸‹è½½æ–‡åº“æ–‡æ¡£  -H "X-API-Key: your_api_key_here" \

  -H "Content-Type: application/json" \

```bash  -d '{"url": "https://blog.csdn.net/xxx/article/details/123456"}'

# æ–‡åº“æ–‡æ¡£ä¼šè‡ªåŠ¨åº”ç”¨Markdownæ¸²æŸ“å’Œä»£ç é«˜äº®```

curl -X POST "http://localhost:8000/api/article/submit" \

  -H "X-API-Key: YOUR_API_KEY" \### ç®¡ç† API Keysï¼ˆéœ€è¦ç®¡ç†å‘˜æƒé™ï¼‰

  -H "Content-Type: application/json" \

  -d '{"url": "https://wenku.csdn.net/answer/3pzv32zt84"}'æ‰€æœ‰ç®¡ç†æ¥å£éœ€è¦æä¾›ç®¡ç†å‘˜å¯†é’¥ï¼ˆX-Admin-Keyï¼‰ï¼š

```

```bash

æ›´å¤šç¤ºä¾‹è¯·æŸ¥çœ‹ [ç¤ºä¾‹ç”¨æ³•æ–‡æ¡£](docs/example_usage.md)ã€‚# åˆ—å‡ºæ‰€æœ‰ API Keys

curl -H "X-Admin-Key: your_admin_key" http://localhost:8000/api/admin/api-keys

## ğŸ“ é¡¹ç›®ç»“æ„

# åˆ›å»ºæ–°çš„ API Key

```curl -X POST "http://localhost:8000/api/admin/api-keys" \

unlock-vip/  -H "X-Admin-Key: your_admin_key" \

â”œâ”€â”€ app/                          # åº”ç”¨ç¨‹åºä»£ç   -H "Content-Type: application/json" \

â”‚   â”œâ”€â”€ api/                      # APIè·¯ç”±  -d '{"name": "æ–°å¯†é’¥", "rate_limit_per_minute": 60}'

â”‚   â”‚   â”œâ”€â”€ admin.py             # ç®¡ç†å‘˜API

â”‚   â”‚   â””â”€â”€ article.py           # æ–‡ç« ä¸‹è½½API# æŸ¥çœ‹ç»Ÿè®¡

â”‚   â”œâ”€â”€ core/                     # æ ¸å¿ƒé…ç½®curl -H "X-Admin-Key: your_admin_key" \

â”‚   â”‚   â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†  http://localhost:8000/api/admin/api-keys/1/stats?days=7

â”‚   â”‚   â””â”€â”€ celery_app.py        # Celeryé…ç½®```

â”‚   â”œâ”€â”€ db/                       # æ•°æ®åº“

â”‚   â”‚   â”œâ”€â”€ database.py          # æ•°æ®åº“è¿æ¥è¯¦è§ï¼š[API è®¤è¯æ–‡æ¡£](docs/API_AUTHENTICATION.md) å’Œ [ç®¡ç†å‘˜å®‰å…¨æŒ‡å—](docs/ADMIN_SECURITY.md)

â”‚   â”‚   â””â”€â”€ models.py            # æ•°æ®æ¨¡å‹

â”‚   â”œâ”€â”€ middleware/               # ä¸­é—´ä»¶## ğŸ³ Docker éƒ¨ç½²

â”‚   â”‚   â””â”€â”€ auth.py              # è®¤è¯ä¸­é—´ä»¶

â”‚   â”œâ”€â”€ models/                   # Pydanticæ¨¡å‹```bash

â”‚   â”‚   â””â”€â”€ schemas.py           # è¯·æ±‚/å“åº”æ¨¡å‹# ä½¿ç”¨ Docker Compose

â”‚   â”œâ”€â”€ services/                 # ä¸šåŠ¡é€»è¾‘docker-compose up -d

â”‚   â”‚   â”œâ”€â”€ article_service.py   # æ–‡ç« ä¸‹è½½æœåŠ¡

â”‚   â”‚   â”œâ”€â”€ wenku_service.py     # æ–‡åº“æœåŠ¡# æŸ¥çœ‹æœåŠ¡çŠ¶æ€

â”‚   â”‚   â”œâ”€â”€ auth_service.py      # è®¤è¯æœåŠ¡docker-compose ps

â”‚   â”‚   â””â”€â”€ captcha_service.py   # éªŒè¯ç æœåŠ¡

â”‚   â”œâ”€â”€ tasks/                    # Celeryä»»åŠ¡# æŸ¥çœ‹æ—¥å¿—

â”‚   â”‚   â”œâ”€â”€ article_tasks.py     # æ–‡ç« ä¸‹è½½ä»»åŠ¡docker-compose logs -f

â”‚   â”‚   â””â”€â”€ cleanup_tasks.py     # æ¸…ç†ä»»åŠ¡```

â”‚   â””â”€â”€ main.py                   # FastAPIåº”ç”¨å…¥å£

â”‚## ğŸ“š æ–‡æ¡£

â”œâ”€â”€ docs/                         # é¡¹ç›®æ–‡æ¡£

â”‚   â”œâ”€â”€ README.md                 # æ–‡æ¡£ç´¢å¼•- [å¿«é€Ÿå¼€å§‹](QUICK_START.md) - æ–°æ‰‹å…¥é—¨æŒ‡å—

â”‚   â”œâ”€â”€ QUICK_START.md           # å¿«é€Ÿå¼€å§‹- [éƒ¨ç½²æŒ‡å—](DEPLOYMENT.md) - è¯¦ç»†çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æ–‡æ¡£

â”‚   â”œâ”€â”€ API_QUICK_REFERENCE.md   # APIå‚è€ƒ- [Docker éƒ¨ç½²](DOCKER_QUICKSTART.md) - Docker å¿«é€Ÿå¼€å§‹

â”‚   â””â”€â”€ ...                       # å…¶ä»–æ–‡æ¡£- [API è®¤è¯](docs/API_AUTHENTICATION.md) - API Key è®¤è¯ç³»ç»Ÿè¯´æ˜

â”‚- [ç®¡ç†å‘˜å®‰å…¨](docs/ADMIN_SECURITY.md) - ç®¡ç†å‘˜å¯†é’¥å®‰å…¨æŒ‡å—

â”œâ”€â”€ scripts/                      # å·¥å…·è„šæœ¬- [æ–‡ä»¶æ¸…ç†](docs/FILE_CLEANUP.md) - è‡ªåŠ¨æ–‡ä»¶æ¸…ç†ç³»ç»Ÿ

â”‚   â”œâ”€â”€ README.md                 # è„šæœ¬è¯´æ˜- [Celery Beat](docs/CELERY_BEAT_GUIDE.md) - å®šæ—¶ä»»åŠ¡é…ç½®æŒ‡å—

â”‚   â”œâ”€â”€ generate_admin_key.py    # ç”Ÿæˆç®¡ç†å‘˜å¯†é’¥- [éªŒè¯ç æœåŠ¡](docs/CAPTCHA_SERVICE.md) - éªŒè¯ç è¯†åˆ«æœåŠ¡é…ç½®

â”‚   â”œâ”€â”€ list_api_keys.py         # æŸ¥çœ‹APIå¯†é’¥

â”‚   â””â”€â”€ manage_db.py             # æ•°æ®åº“ç®¡ç†## ğŸ”§ ç”Ÿäº§ç¯å¢ƒ

â”‚

â”œâ”€â”€ tests/                        # æµ‹è¯•ä»£ç ### æ£€æŸ¥ç¯å¢ƒ

â”‚   â”œâ”€â”€ test_wenku_download.py   # æ–‡åº“ä¸‹è½½æµ‹è¯•

â”‚   â”œâ”€â”€ test_complete_flow.py    # å®Œæ•´æµç¨‹æµ‹è¯•```bash

â”‚   â””â”€â”€ ...python production_check.py

â”‚```

â”œâ”€â”€ docker-compose.yml            # Docker Composeé…ç½®

â”œâ”€â”€ Dockerfile                    # Dockeré•œåƒæ„å»º### éƒ¨ç½²é€‰é¡¹

â”œâ”€â”€ requirements.txt              # Pythonä¾èµ–

â”œâ”€â”€ run.py                        # å¯åŠ¨è„šæœ¬1. **Docker Compose**ï¼ˆæ¨èï¼‰

â”œâ”€â”€ celery_worker.py             # Celery Worker   ```bash

â””â”€â”€ README.md                     # æœ¬æ–‡ä»¶   docker-compose up -d

```   ```



## ğŸ”§ é…ç½®è¯´æ˜2. **Supervisor** (Linux)

   å‚è€ƒ [DEPLOYMENT.md](DEPLOYMENT.md) ä¸­çš„é…ç½®

### ç¯å¢ƒå˜é‡

3. **PM2** (Windows/Linux)

åœ¨ `.env` æ–‡ä»¶ä¸­é…ç½®ä»¥ä¸‹å˜é‡ï¼š   ```bash

   pm2 start run.py --name unlock-vip-api --interpreter python

```env   pm2 start "celery -A app.core.celery_app worker" --name unlock-vip-celery

# MySQLæ•°æ®åº“   ```

MYSQL_HOST=localhost

MYSQL_PORT=3306## ğŸ“Š ç›‘æ§

MYSQL_USER=root

MYSQL_PASSWORD=your_passwordå®‰è£…å¹¶å¯åŠ¨ Flower:

MYSQL_DATABASE=unlock_vip

```bash

# Redispip install flower

REDIS_HOST=localhostcelery -A app.core.celery_app flower --port=5555

REDIS_PORT=6379```

REDIS_DB=0

è®¿é—®: http://localhost:5555

# ç®¡ç†å‘˜å¯†é’¥

ADMIN_MASTER_KEY=your_secure_admin_key## ğŸ› æ•…éšœæ’æŸ¥



# CSDN Cookiesï¼ˆå¯é€‰ï¼‰### Redis è¿æ¥å¤±è´¥

# å°†cookies.jsonæ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•

``````bash

# æ£€æŸ¥ Redis

### Cookiesé…ç½®ï¼ˆæ–‡åº“åŠŸèƒ½ï¼‰docker ps | grep redis

docker logs unlock-vip-redis

æ–‡åº“æ–‡æ¡£ä¸‹è½½éœ€è¦CSDNç™»å½•cookiesï¼š```



1. ç™»å½• CSDN### Worker æœªå¤„ç†ä»»åŠ¡

2. ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·å¯¼å‡ºcookies

3. ä¿å­˜ä¸º `cookies.json`ï¼š```bash

# æ£€æŸ¥ Worker çŠ¶æ€

```jsoncelery -A app.core.celery_app inspect active

{```

  "UserToken": "your_token_value",

  "UserName": "your_username",### ä¸‹è½½å¤±è´¥

  ...

}- æ£€æŸ¥ CSDN è´¦å·æ˜¯å¦æœ‰æ•ˆ

```- ç¡®è®¤ cookies.json æ–‡ä»¶å­˜åœ¨

- æŸ¥çœ‹ Worker æ—¥å¿—äº†è§£è¯¦ç»†é”™è¯¯

## ğŸ› ï¸ ç»´æŠ¤å·¥å…·

## ğŸ“ å¼€å‘

### æ•°æ®åº“ç®¡ç†

### é¡¹ç›®ç»“æ„

```bash

# åˆå§‹åŒ–æ•°æ®åº“```

python scripts/manage_db.pyunlock-vip/

â”œâ”€â”€ app/

# æŸ¥çœ‹APIå¯†é’¥â”‚   â”œâ”€â”€ api/              # API è·¯ç”±

python scripts/list_api_keys.pyâ”‚   â”œâ”€â”€ core/             # æ ¸å¿ƒé…ç½®

â”‚   â”œâ”€â”€ models/           # æ•°æ®æ¨¡å‹

# ç”Ÿæˆç®¡ç†å‘˜å¯†é’¥â”‚   â”œâ”€â”€ services/         # ä¸šåŠ¡é€»è¾‘

python scripts/generate_admin_key.pyâ”‚   â””â”€â”€ tasks/            # Celery ä»»åŠ¡

â”œâ”€â”€ tests/                # æµ‹è¯•æ–‡ä»¶

# ç”Ÿæˆæµ‹è¯•å¯†é’¥â”œâ”€â”€ docs/                 # æ–‡æ¡£

python scripts/generate_test_key.pyâ””â”€â”€ downloads/            # ä¸‹è½½ç›®å½•

``````



### æœåŠ¡ç®¡ç†### è¿è¡Œæµ‹è¯•



```bash```bash

# å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆDockerï¼‰# ç®€å•æµ‹è¯•

docker-compose up -dpython tests/test_simple.py



# æŸ¥çœ‹æ—¥å¿—# Celery å®¢æˆ·ç«¯æµ‹è¯•

docker-compose logs -fpython tests/test_celery_client.py

```

# é‡å¯æœåŠ¡

docker-compose restart## âš™ï¸ é…ç½®è¯´æ˜



# åœæ­¢æœåŠ¡### Celery é…ç½®

docker-compose down

```ç¼–è¾‘ `app/core/celery_app.py`:



## ğŸ“Š æ€§èƒ½ç‰¹ç‚¹```python

task_time_limit=30 * 60,          # 30åˆ†é’Ÿè¶…æ—¶

- **å¹¶å‘å¤„ç†**: æ”¯æŒå¤šä¸ªä»»åŠ¡åŒæ—¶ä¸‹è½½worker_prefetch_multiplier=1,      # é¢„å–ä»»åŠ¡æ•°

- **å¼‚æ­¥éé˜»å¡**: FastAPIå¼‚æ­¥å¤„ç†ï¼Œé«˜ååé‡```

- **ä»»åŠ¡é˜Ÿåˆ—**: Celeryåˆ†å¸ƒå¼ä»»åŠ¡ï¼Œå¯æ¨ªå‘æ‰©å±•

- **ç¼“å­˜æœºåˆ¶**: Redisç¼“å­˜ï¼Œå‡å°‘é‡å¤è¯·æ±‚### API è¶…æ—¶é…ç½®

- **è‡ªåŠ¨æ¸…ç†**: å®šæœŸæ¸…ç†è¿‡æœŸæ–‡ä»¶ï¼ŒèŠ‚çœå­˜å‚¨

ç¼–è¾‘ `app/api/article.py`:

## ğŸ”’ å®‰å…¨ç‰¹æ€§

```python

- âœ… APIå¯†é’¥è®¤è¯timeout = 300  # 5åˆ†é’Ÿè¶…æ—¶

- âœ… é€Ÿç‡é™åˆ¶ä¿æŠ¤```

- âœ… è¯·æ±‚æ—¥å¿—è®°å½•

- âœ… SQLæ³¨å…¥é˜²æŠ¤ï¼ˆORMï¼‰## ğŸ” å®‰å…¨å»ºè®®

- âœ… XSSé˜²æŠ¤

- âœ… CORSé…ç½®- âœ… ä¸è¦å°† `.env` æ–‡ä»¶æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶

- âœ… å®šæœŸè½®æ¢ç®¡ç†å‘˜å¯†é’¥ï¼ˆå»ºè®® 90 å¤©ï¼‰

## ğŸ¤ è´¡çŒ®- âœ… åªå°†ç®¡ç†å‘˜å¯†é’¥åˆ†å‘ç»™å¿…è¦äººå‘˜

- âœ… ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ HTTPS

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼- âœ… ä¸ºç®¡ç†æ¥å£é…ç½® IP ç™½åå•

- âœ… Redis è®¾ç½®å¯†ç ä¿æŠ¤

1. Fork æœ¬ä»“åº“- âœ… MySQL ä½¿ç”¨å¼ºå¯†ç 

2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)- âœ… å®šæœŸæ›´æ–°ä¾èµ–åŒ…

3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)- âœ… ç›‘æ§ API è®¤è¯å¤±è´¥æ¬¡æ•°

4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)

5. å¼€å¯Pull Requestè¯¦è§ï¼š[ç®¡ç†å‘˜å®‰å…¨æŒ‡å—](docs/ADMIN_SECURITY.md)



## ğŸ“„ è®¸å¯è¯## ğŸ“„ License



æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚MIT License



## ğŸ™ è‡´è°¢## ğŸ¤ è´¡çŒ®



- [FastAPI](https://fastapi.tiangolo.com/) - ç°ä»£åŒ–çš„Webæ¡†æ¶æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

- [Celery](https://docs.celeryproject.org/) - åˆ†å¸ƒå¼ä»»åŠ¡é˜Ÿåˆ—

- [BeautifulSoup](https://www.crummy.com/software/BeautifulSoup/) - HTMLè§£æ---

- [Python-Markdown](https://python-markdown.github.io/) - Markdownæ¸²æŸ“

**æ³¨æ„**: æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·éµå®ˆ CSDN æœåŠ¡æ¡æ¬¾ã€‚

## ğŸ“ è”ç³»æ–¹å¼

- **GitHub**: [@minglu6](https://github.com/minglu6)
- **Issues**: [æäº¤é—®é¢˜](https://github.com/minglu6/unlock-vip/issues)
- **æ–‡æ¡£**: [docs/README.md](docs/README.md)

---

**âš ï¸ å…è´£å£°æ˜**: æœ¬é¡¹ç›®ä»…ä¾›å­¦ä¹ äº¤æµä½¿ç”¨ï¼Œè¯·éµå®ˆCSDNçš„æœåŠ¡æ¡æ¬¾ã€‚ä½¿ç”¨æœ¬å·¥å…·ä¸‹è½½çš„å†…å®¹ç‰ˆæƒå½’åŸä½œè€…æ‰€æœ‰ã€‚
